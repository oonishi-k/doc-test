【身内向けのPython講座】 その2 Pythonのデータ型
=======================================================================

身内向けのPython講座 第2回です。  
ここでは、Pythonのデータ型の内、言語のプリミティブな型(C言語でいうところの`int`、`double`等)を扱います。  
IDLE(GUI)を立ち上げて実際に動かしながら読んでもらえると、イメージしやすいかと思います。  


<!-- more -->


Pythonの組み込み型
------------------

Pythonのプリミティブな型には以下のものがあります。  

#### intとfloatとbool
数値型として、int、float、boolがあります。  
intはC言語の整数値と違って、上限、下限がありません。
floatは浮動小数点型で、精度はC言語のdouble型に等しく、有効数字が15桁、指数で`10の308乗`まで表現できます  
boolはC++などのbool値に等しく、True、Falseのみで表される値です。  
これらの数値型に対する算術演算(+-/*%)や比較演算(==、<、>)は、基本C言語と共通です。  
ただ"/"には注意が必要で、<整数値>/<整数値>の結果はfloatとなります。  
```python
>>> # +,-,*,/,%の他に"**"(累乗)も可能です
>>> 2 ** 3
8
>>> # intには上限下限がありません。
>>> 10 ** 100
10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
>>> # intはビット演算(<<、>>、&、|、^、~)も可能です
>>> 1 << 8
256
>>> # int同士の割り算はfloatになります
>>> 9 / 6
1.5
>>> # "//"を使うと整数値が得られます
>>> 9 // 6
1
```


#### 文字列とバイト列
文字列を表す記号は`"`と`'`の二種類が使えます。(どちらでもいい)  
Pythonの文字列は、文字コードの指定されていないユニコード文字列です。  
(ユニコード自体は文字コードではないことに注意して下さい)  
なので、ファイルとの入出力の際には文字コードを指定し(utf16,sjis,...)、バイト列に変換する必要があります。  

```python
>>> # "+"で結合、"=="で比較ができます
>>> 'Hello' + 'World' == "HelloWorld"
True
>>> # 文字コードを指定し、バイト列に変換します
>>> 'こんにちわ'.encode('sjis')
b'\x82\xb1\x82\xf1\x82\xc9\x82\xbf\x82\xcd'
>>> # 文字コードを指定し、バイト列を文字列に戻す
>>> b'\x82\xb1\x82\xf1\x82\xc9\x82\xbf\x82\xcd'.decode('sjis')
'こんにちわ'
```


#### リストとタプル
配列型として、リストとタプルがあります。  
どちらも、どんな型の値でも格納できます。  
両者の違いは、リストは、格納された値を後から変更可能ですが、タプルは宣言時から変更できない点です。  

```python
>>> # []で囲むとリストです
>>> [0,1,2,'hello']
[0,1,2,'hello']
>>> # ()で囲むとタプルです
>>> (0,1,2,'hello')
(0,1,2,'hello')
>>> # リストの値は後から変更できます
>>> l = [0,1,2]
>>> l[0] = b'test'
>>> l
[b'test',1,2]
>>> # タプルの値は変更できません
>>> t = (0,1,2)
>>> t[0] = b'test'
"""Traceback (most recent call last):
  File "<pyshell#2>", line 1, in <module>
    t[0] = b'test'
TypeError: 'tuple' object does not support item assignment"""
```

上のコードの最後の4行* Traceback ～ *は例外が投げられたことを示すメッセージです。  
例外については、C言語にはない概念ですが、C++以降のほとんどの言語に存在する概念なので問題無いと思います。  

また、リストとタプルの最大の違いは、**リストは参照型**、**タプルは値型**という点です。   

```python
>>> # リストは参照型なので、l,l2は同じ実体を指す
>>> l = [0,1]
>>> l2 = l
>>> l += [2]
>>> l
[0,1,2]
>>> l2
[0,1,2]
>>> # タプルは値型なので、t,t2は実体も別です
>>> t = (0,1)
>>> t2= t
>>> t += (2,)
>>> t
(0,1,2)
>>> t2
(0,1)
```


#### 辞書型とセット型

辞書型は一般名詞でいうと連想配列、C++でいうところのstd::mapにあたります。  
キーと値を関連付けて、保持、取り出しが行えます。  
```python
>>> d = {0:'test', 1:'hello'}
>>> d[0]
'test'
>>> d['foo'] = 'var'
>>> d
{0:'test', 1:'hello', 'foo':'var'}
>>> d[2]
"""Traceback (most recent call last):
  File "<pyshell#4>", line 1, in <module>
    d[2]
KeyError: 2"""
```

セット型は、値がユニークになる配列で、C++でいうとstd::setなります
```python
>>> s = {0,1,2}
>>> s.add(3)
>>> s
{0,1,2,3}
>>> s.add(2)
{0,1,2,3}
>>> # <value> in <set>は要素<value>が含まれる時にTrueを返します
>>> 2 in s
True
>>> 4 in s
False
```


値型と参照型
------------
Java以降のほとんどの言語と同様に、Pythonにも値型と参照型の区別があります。  
リスト、辞書、set(とユーザ定義型)は常に参照型、それ以外のint、float、文字列、バイト、タプルは常に値型です。  

```python
>>> # intは値型なので、aとbは実体として異なります
>>> a = 0
>>> b = a
>>> b += 1
>>> print(a, b)
0 1
>>> # 以下、関数定義です
>>> def foo(n):
		n += 1
		print(n)
		
>>> x = 3
>>> # xはfooに渡される際にコピーされます
>>> foo(x)
4
>>> x
3
```

  

```python
>>> # リストは参照型なので、aとbは同じ実体を指します
>>> a = [0]
>>> b = a
>>> b += [1]
>>> print(a,b)
[0､1] [0,1]
>>> def foo(l):
		l += [1]
		print(l)
		
>>> r = [0]
>>> # fooには[0]を指す参照が渡されます
>>> foo(r)
[0,1]
>>> r
[0,1]
```





